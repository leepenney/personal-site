<!DOCTYPE html><html lang="en-GB"><head><meta charset="utf-8"><title>My Media Centre Overhaul &gt; Tech &gt; Lee Penney</title><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="description" content="Since installing my HD card, live TV (HD channels) has never really worked. After a period of time the sound would begin to stutter and eventually disappear altogether. Stopping and restarting the "><meta property="og:title" content="My Media Centre Overhaul"><meta property="og:description" content="Since installing my HD card, live TV (HD channels) has never really worked. After a period of time the sound would begin to stutter and eventually disappear altogether. Stopping and restarting the "><meta property="og:url" content="https://www.leepenney.com/tech/my-media-centre-overhaul.html"><meta property="og:type" content="article"><link rel="canonical" href="https://www.leepenney.com/tech/my-media-centre-overhaul.html"><link rel="icon" href="https://www.leepenney.com/img/favicon.ico" type="image/x-icon"><style>body{color:#212121;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;letter-spacing:.02em;padding:0 20px;margin:0 auto;max-width:800px}a{color:#212121;text-decoration:none}dt{font-weight:700;font-size:1.2em}dt a{display:block;padding:10px 0 5px 0}dd,div.meta{margin:0 0 1em 0;color:#aaa;font-size:90%}code{font-family:monospace;font-size:120%}header{border-bottom:1px solid;padding:20px 0}header:after{content:"";display:table;clear:both}header svg{float:left;margin:0 10px 0 0}header nav,header span{vertical-align:middle}header nav{line-height:55px}header nav a{border-bottom:1px dotted}main{margin:20px 0}main.home section{display:grid;grid-template-columns:1fr 1fr;grid-auto-rows:calc((100vw - 40px)/ 2);column-gap:10px;row-gap:10px;margin:0 0 3em 0;grid-template-rows:2em}.cat-block{display:block;color:#fff;background:#212121;text-decoration:none;text-align:center;line-height:calc((100vw - 40px)/ 2)}.cat-block:nth-child(1){grid-column-start:1;grid-column-end:3;line-height:normal;color:#212121;background:#fff}span.tag{background:#eaedee;display:inline-block;margin:0 7px 0 0;border-radius:5px;padding:0 10px}main.books dl{padding:0 0 0 90px}main.books dd:after{content:"";display:table;clear:both}main.books dl img{height:120px;width:80px;float:left;margin:-1.6em 0 0 -90px}article img{max-width:100%;height:auto}article hr{display:none}article table{border-collapse:collapse;border:none!important;margin:1em auto}article tr{border-bottom:1px dotted}article td,article th{border:none!important;padding:.5em 1em}article li{margin:0 0 1em 0}article a{border-bottom:1px dotted}main.book article img{height:180px;width:120px;display:block;margin:0 1em 0 0;float:left}main.book article p:first-of-type+ul{list-style-type:none;float:left;padding:0;width:120px;margin:1em 1em 1em 0;font-size:90%;clear:left;text-transform:uppercase;text-align:center}main.book article ul a{display:block;background:#000;color:#fff;line-height:40px;padding:5px;font-size:80%;font-weight:700;margin:0 0 2px 0}form{max-width:400px;margin:0 auto}label{display:block;margin:0;padding:0}input{display:block;font-size:1em;margin-bottom:1em;width:100%;padding:5px;box-sizing:border-box}input[type=submit]{background:#000;color:#fff;border:0;height:40px}main.book section{border-top:1px solid}footer{border-top:1px solid}@media screen and (min-width:800px){header span{line-height:55px}main.home section{grid-template-columns:repeat(4,1fr);grid-auto-rows:1fr;grid-template-rows:unset}.cat-block:nth-child(1){grid-column-start:1;grid-column-end:2;font-weight:700;line-height:195px}.cat-block:nth-child(3n+2){grid-column-start:2}.cat-block{line-height:195px}main.books dl{padding:0;display:grid;grid-template-columns:1fr 1fr;grid-auto-flow:dense}main.books dt{padding:0 0 0 calc(73px + 1em)}main.books dl>:nth-of-type(odd){grid-column:1}main.books dl>:nth-of-type(even){grid-column:2}main.books dl img{margin:-1em 1em 0 0}}</style></head><body><header><a href="/"><svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 400 400"><path d="M0 200v200h400V0H0v200zm60-68v60l56.3-.2 56.2-.3.5-40c.6-45.8.6-45.5 9.5-57.9 7.7-10.7 19.8-18.1 34.2-20.7 3.2-.6 26.4-.9 57.5-.6 46.5.3 53 .5 58.2 2.1 22.7 6.8 38.1 21.9 46.3 45.6 2.4 7 2.7 9 3.1 29.1.3 19.5.2 22.5-1.7 29.9-5.2 20.7-17 34.9-36.6 44-12.2 5.8-19.5 7-40.7 7-10.1 0-34.8.3-55 .7l-36.8.6V344h-39.3l.6-57 .7-57h-67.5c-58.7 0-68-.2-71.3-1.5-4.9-2.1-8.1-5.2-10.3-10-1.7-3.8-1.9-8.1-1.9-75.3V72h38v60z"/><path d="M219 111.3c-1.9.7-4.4 2.7-5.7 4.6-2.3 3.4-2.3 3.5-2.3 39.8v36.4l54.8-.3 54.7-.3 5.6-2.6c6.5-3.1 11.9-8.2 15.1-14.2 2.1-3.9 2.3-5.4 2.3-22.2 0-17.7-.1-18.1-2.8-24.1-3.4-7.4-8.4-12.5-15.2-15.6-5-2.3-5.2-2.3-54-2.5-36.3-.2-49.9.1-52.5 1z"/></svg></a><nav><a href="https://www.leepenney.com/index.html">Home</a> &gt; <a href="https://www.leepenney.com/tech">Tech</a></nav></header><main class="features tech vfd"><article><h1>My Media Centre Overhaul</h1><div class="meta">26 May, 2014 | <span class="tag">Features</span><span class="tag">Tech</span><span class="tag">Vfd</span></div><p>Since installing my HD card, live TV (HD channels) has never really worked. After a period of time the sound would begin to stutter and eventually disappear altogether. Stopping and restarting the channel would solve it, but only for a while.</p><p>I've looked for solutions before, such as increasing the size of the buffer pool (assuming it was when the buffer was full and it needed to start overwriting that the problem occurred). Nothing fixed it, so recently I decided on a complete rebuild, switching to Windows 8 at the same time.</p><hr id="read-more"><h3>Sorting out the display</h3><p>The first issue I encountered on the rebuild was getting my screen to fit my TV. Despite Windows 8 picking up the appropriate display drivers, I was getting serious underscan (the picture was smaller than the screen). I made sure my TV (an LG model) was set to Just Scan (i.e. don't try and resize, just show what you're receiving), but it made no difference.</p><p>On my previous setup I used the Catalyst Control Centre, which allows some adjustment of the underscan, although I never got it to use every pixel.</p><p>So, off to the internet I went, and here's how I solved it (without CCC):</p><p><strong>Note:</strong> Needless to say, making changes to the registry is dangerous, either take a backup first, or be prepared for a fresh install should something go wrong.</p><h3>Registry hack to remove underscan</h3><p>I'm sure that, the first time I wiped it, I only had to use the following registry hack (which I found on <a href="http://superuser.com/questions/458321/change-overscan-underscan-settings-without-catalyst-control-center">Superuser</a>, but traces back to <a href="http://forum.beyond3d.com/showpost.php?s=d065c06991d906d708cbb162130f369c&amp;p=1653814&amp;postcount=24">here</a>):</p><blockquote style="padding:20px 30px"><p>Go to the following key in the registry:</p><p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\video{####....}\0000</p><p>Create a new DWORD:</p><p>"DigitalHDTVDefaultUnderscan" = dword 0x0000</p><p><strong>Note:</strong> there might be several {####....} , should be the one with most of the ATI settings.</p></blockquote><p>The second time around, I had to do an additional change in the registry though (which I found <a href="http://www.avsforum.com/t/1251639/how-i-fixed-overscan-underscan-issues-on-an-ati-card-without-catalyst-control-center">here</a>):</p><blockquote style="padding:20px 30px"><p>Open regedit and go to:</p><p>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Video\</p><p>In there, there'll be some keys looking like this:</p><p>{ECA904C2-25E6-4680-9B2C-44EBC0EC9190} (with different numbers and letters)</p><p>Highlight the "Video" key at the top of the tree, and do a search for "1920x1080" (or whatever resolution you want to change).</p><p>You'll find some keys in subfolders named 0000, 0001, etc.</p><p>The keys will begin with DALR6 DFP<strong>XXXX</strong>x<strong>YYYY</strong>x0x<strong>FF</strong></p><p><strong>XXXX</strong>= Horizontal resolution<br><strong>YYYY</strong>= Vertical resolution<br><strong>FF</strong>= Display frequency</p><p>Click on the key matching the screen resolution and frequency you want to remove the borders of.</p><p>A lot of the key will consist of "00", but there'll be a few non-00 entries. Change all of these to 00.</p><p>Finally, I had two subfolders, 0000 and 0001, containing mirrors of the same keys. When I changed a key in one subfolder, it also changed in the other.</p></blockquote><h3>Fixing the underscan in Media Center</h3><p>The above sorted my underscan issue for windows, but Media Center was still too small. I tried changing the resolution within Media Center, but to no avail. In the end, I found the comment by NitDawg on <a href="http://www.missingremote.com/guide/missing-remote-tips-and-tweaks-2-preventing-sneaky-tv-overscan-windows-7-media-center">this page</a> did the job:</p><blockquote style="padding:20px 30px"><p>To push the UI elements back out to the corners after getting rid of overscan, you can modify the registry:</p><p>[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Media Center\Settings\MCE.PerUserSettings]</p><p>"marginLeft"=dword:00000000</p><p>"marginTop"=dword:00000000</p><p>"marginRight"=dword:00000000</p><p>"marginBottom"=dword:00000000</p><p>"marginSaved"=dword:00000001</p><p>"useDefaultOverscanMargins"=dword:00000000</p></blockquote><h3>Resolving HD sound stutter</h3><p>Initially, with a clean install, the HD channels didn't seem too bad, a little popping here and there, but no loss of sound. By the time I'd got everything else up and running it was struggling though.</p><p>I rip my Blu-ray discs to MKV format, so I was going to need a splitter. Previously, I think I used Haali as part of another codec pack, but I decided on the <a href="https://code.google.com/p/lavfilters/">LAV Filters</a> this time around.</p><p>What has this got to do with HD channels? Well, I stumbled across an <a href="http://www.amazon.co.uk/review/R14XLW7FAQYTL9/ref=cm_cr_pr_cmt?ie=UTF8&amp;ASIN=B006MTN32A">Amazon comment</a> on a slightly different TBS HD card that mentioned using an alternative codec for live TV. So I grabbed a copy of the <a href="http://thedigitallifestyle.com/w/index.php/2009/04/14/announcing-mcdu-the-media-center-decoder-utility-replaces-vmcd/">Media Center Decoder Utility </a>(MCDU) and changed it to using the LAV Filters.</p><p>Not only did it sort the issues I had with the sound, but it seems to have improved the picture quality too. There are some negatives: no screenshot when viewing the shows in Recorded TV, and no audio when fast forwarding.</p><h3>A setback</h3><p>I mentioned above that I had wiped my machine twice, because while the LAV Filters worked perfectly on the MKVs using H.264, I had delayed sound on any that contained VC1/Dolby content. I tried a ton of other codec packs, and found that the only way to resolve it was to install the ArcSoft one from a copy of TotalMedia Theatre.</p><p>The problem with that was it borked my HD playback again (not sure if was just the ArcSoft or the various other codecs I installed). Hence why I had to wipe the machine and start over.</p><p>So, for now, my VC1 playback isn't right. Not sure what to try on that. I could reinstall just the codecs that worked and see how that goes, but I'd rather avoid it if I can. I could transcode my VC1 files to H.264. Or I can keep trying combinations of settings to see if I can pull the audio back into line.</p><h3>Setting up the rest</h3><p>I've used <a href="http://mediabrowser.tv/">Media Browser</a> for a while now. One issue I had was that, when saving series to different disks, they appeared multiple times in MB. So, this time, I pooled my disks, not using RAID, but in software using <a href="http://stablebit.com/drivepool">StableBit DrivePool</a>. It means I can add additional disks, or change disk sizes, without having to rebuild everything, and as it stores it all in regular NTFS, I don't have to worry about it becoming unreadable should a disk fail.</p><p>I will say that the new version of Media Browser (version 3), which uses a split server/app architecture, while offering many more features, is heavier on resources. In fact, I've currently got backdrops switched off, because just going through the list in coverflow was unbelievably slow (I'm using Classic rather than the new Theater option).</p><p>I'd forgotten how much I loathed Media Center's default blue theme. Media Center Studio seems to have died (although you can work around the installation issues), so that left the option of <a href="http://www.patchou.com/projects/media-center-themer/">Media Center Themer</a>, or the <a href="http://www.acs-digital-media.com/">MCE Reset Tool</a> (MCE RTB).</p><p>The latter is a costed option, but does already have Astrotoy7's black theme available, plus allows you to edit the menus (I removed all bar TV, Media Browser and Settings), the guide (I added some extra rows), add channel logos, and some other stuff.</p><h3>Finishing up</h3><p>So, that was pretty much it. I had a functioning machine that looked good. I still need to sort out VC1 playback, and I'm going to look at ways to get the box to stream live TV to my tablets.</p><p>Still, not bad considering this is all running on my original (nearly five year old) hardware (albeit with an additional TV card and various upgrades to the HDDs).</p></article></main><footer><p>&copy; Lee Penney. All rights reserved.</p></footer></body></html>