<!DOCTYPE html><html lang="en-GB"><head><meta charset="utf-8"><title>I am Not a Book Pirate &gt; Other &gt; Lee Penney</title><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="description" content="Over the past few weeks I have received a few offers, both via Twitter and private messages on the Kindle Users Forum, along the lines of:&lt;/"><meta property="og:title" content="I am Not a Book Pirate"><meta property="og:description" content="Over the past few weeks I have received a few offers, both via Twitter and private messages on the Kindle Users Forum, along the lines of:&lt;/"><meta property="og:url" content="https://www.leepenney.com/other/i-am-not-a-book-pirate.html"><meta property="og:type" content="article"><link rel="canonical" href="https://www.leepenney.com/other/i-am-not-a-book-pirate.html"><link rel="icon" href="https://www.leepenney.com/img/favicon.ico" type="image/x-icon"><style>body{color:#212121;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;letter-spacing:.02em;padding:0 20px;margin:0 auto;max-width:800px}a{color:#212121;text-decoration:none}dt{font-weight:700;font-size:1.2em}dt a{display:block;padding:10px 0 5px 0}dd,div.meta{margin:0 0 1em 0;color:#aaa;font-size:90%}code{font-family:monospace;font-size:120%}header{border-bottom:1px solid;padding:20px 0}header:after{content:"";display:table;clear:both}header svg{float:left;margin:0 10px 0 0}header nav,header span{vertical-align:middle}header nav{line-height:55px}header nav a{border-bottom:1px dotted}main{margin:20px 0}main.home section{display:grid;grid-template-columns:1fr 1fr;grid-auto-rows:calc((100vw - 40px)/ 2);column-gap:10px;row-gap:10px;margin:0 0 3em 0;grid-template-rows:2em}.cat-block{display:block;color:#fff;background:#212121;text-decoration:none;text-align:center;line-height:calc((100vw - 40px)/ 2)}.cat-block:nth-child(1){grid-column-start:1;grid-column-end:3;line-height:normal;color:#212121;background:#fff}span.tag{background:#eaedee;display:inline-block;margin:0 7px 0 0;border-radius:5px;padding:0 10px}main.books dl{padding:0 0 0 90px}main.books dd:after{content:"";display:table;clear:both}main.books dl img{height:120px;width:80px;float:left;margin:-1.6em 0 0 -90px}article img{max-width:100%;height:auto}article hr{display:none}article table{border-collapse:collapse;border:none!important;margin:1em auto}article tr{border-bottom:1px dotted}article td,article th{border:none!important;padding:.5em 1em}article li{margin:0 0 1em 0}article a{border-bottom:1px dotted}main.book article img{height:180px;width:120px;display:block;margin:0 1em 0 0;float:left}main.book article p:first-of-type+ul{list-style-type:none;float:left;padding:0;width:120px;margin:1em 1em 1em 0;font-size:90%;clear:left;text-transform:uppercase;text-align:center}main.book article ul a{display:block;background:#000;color:#fff;line-height:40px;padding:5px;font-size:80%;font-weight:700;margin:0 0 2px 0}form{max-width:400px;margin:0 auto}label{display:block;margin:0;padding:0}input{display:block;font-size:1em;margin-bottom:1em;width:100%;padding:5px;box-sizing:border-box}input[type=submit]{background:#000;color:#fff;border:0;height:40px}main.book section{border-top:1px solid}footer{border-top:1px solid}@media screen and (min-width:800px){header span{line-height:55px}main.home section{grid-template-columns:repeat(4,1fr);grid-auto-rows:1fr;grid-template-rows:unset}.cat-block:nth-child(1){grid-column-start:1;grid-column-end:2;font-weight:700;line-height:195px}.cat-block:nth-child(3n+2){grid-column-start:2}.cat-block{line-height:195px}main.books dl{padding:0;display:grid;grid-template-columns:1fr 1fr;grid-auto-flow:dense}main.books dt{padding:0 0 0 calc(73px + 1em)}main.books dl>:nth-of-type(odd){grid-column:1}main.books dl>:nth-of-type(even){grid-column:2}main.books dl img{margin:-1em 1em 0 0}}</style></head><body><header><a href="/"><svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="55" height="55" viewBox="0 0 400 400"><path d="M0 200v200h400V0H0v200zm60-68v60l56.3-.2 56.2-.3.5-40c.6-45.8.6-45.5 9.5-57.9 7.7-10.7 19.8-18.1 34.2-20.7 3.2-.6 26.4-.9 57.5-.6 46.5.3 53 .5 58.2 2.1 22.7 6.8 38.1 21.9 46.3 45.6 2.4 7 2.7 9 3.1 29.1.3 19.5.2 22.5-1.7 29.9-5.2 20.7-17 34.9-36.6 44-12.2 5.8-19.5 7-40.7 7-10.1 0-34.8.3-55 .7l-36.8.6V344h-39.3l.6-57 .7-57h-67.5c-58.7 0-68-.2-71.3-1.5-4.9-2.1-8.1-5.2-10.3-10-1.7-3.8-1.9-8.1-1.9-75.3V72h38v60z"/><path d="M219 111.3c-1.9.7-4.4 2.7-5.7 4.6-2.3 3.4-2.3 3.5-2.3 39.8v36.4l54.8-.3 54.7-.3 5.6-2.6c6.5-3.1 11.9-8.2 15.1-14.2 2.1-3.9 2.3-5.4 2.3-22.2 0-17.7-.1-18.1-2.8-24.1-3.4-7.4-8.4-12.5-15.2-15.6-5-2.3-5.2-2.3-54-2.5-36.3-.2-49.9.1-52.5 1z"/></svg></a><nav><a href="https://www.leepenney.com/index.html">Home</a> &gt; <a href="https://www.leepenney.com/other">Other</a></nav></header><main class="Written Word piracy"><article><h1>I am Not a Book Pirate</h1><div class="meta">10 Apr, 2015 | <span class="tag">Written Word</span><span class="tag">Piracy</span></div><div class="entry-content"><p>Over the past few weeks I have received a few offers, both via Twitter and private messages on the <a href="http://www.kuforum.co.uk/kindleusersforum/">Kindle Users Forum</a>, along the lines of:</p><blockquote><p>I see you’re interested in a free copy of my book, did you find it? If not, I’m happy to send you one.</p></blockquote><p>I assumed they were spam and deleted or ignored them.</p><p>Then I was accused of stealing by an author I’d never heard of because of the supposed posts I’d made about getting free copies. That’s when I decided it was time to take action. It led me on quite a journey.</p><h3 id="the-investigation-begins">The Investigation Begins</h3><p>My accuser was kind enough to provide me a link, to a site that looked like the openmamba (a linux distro) forums. None of the users who had posted on the thread were me, so I was curious how I had been linked to this request. Within an hour or two I had other people tweet me to say they were about to accuse me of the same thing. So I started digging.</p><p>Although the forum looked to be openmamba, I immediately clocked that the domain didn’t look legitimate. It ended in .mk, which turned out to belong to Macedonia. I assumed this was a pirate site hosting a forum dedicated to illicit material, but the main domain looked legit.</p><p>Clicking on any of the avatars took me through the actual domain, but to the profile of a totally different user.</p><p>Checking the KUF forum, I found others were <a href="http://www.kuforum.co.uk/kindleusersforum/thread-18215.html">having the same issue</a>, both finding requests for their books and receiving messages about being pirates.</p><h3 id="pirate-sites">Pirate Sites</h3><p>Another <a href="http://www.kuforum.co.uk/kindleusersforum/thread-18220.html">post on the forum</a> led me to a site that appeared to be offering free ebook downloads. I’ve heard of people finding their books available for free, but there was something odd about this one. Almost every link went to a registration page. The copyright in the footer included “Sainsbury’s Entertainment Ltd is a wholly-owned subsidiary of Sainsbury’s Supermarkets Ltd.” So I went looking and found the site resembled <a href="http://www.sainsburysebooks.co.uk/">eBooks by Sainsbury’s</a>. Someone had ripped off their site design and hadn’t even bothered to change the text in the footer.</p><p>A web search for that phrase turned up a whole heap of sites that blatantly weren’t what they were purporting to be.</p><p>I emailed Sainsbury’s (I figured they’d have more resources than me), who said they were already working on this.</p><p>Looking at the domains being used, they were obviously legitimate at some stage, so it appeared the sites had been hacked and the content replaced. For what purpose I still don’t know (the registration page doesn’t appear to do anything but lead you to a success page and links to books that lead off-site). Hacked Domains</p><p>These hacked sites appeared to be something different to the original link I received (although links on them did go out to similar pages). So I did another search, this time for the book(s) I had originally been accused of stealing.</p><p>That turned up some interesting results, because there were a lot of sites, but I quickly noticed a pattern. The pages which housed these fake forum pages had a pattern:</p><blockquote><p>http://&lt;top-level-domain/libri—</p></blockquote><p>You can easily see these by <a href="https://www.google.co.uk/search?q=%22lee+penney%22+holdfast+free&amp;ie=utf-8&amp;oe=utf-8&amp;gfe_rd=cr&amp;ei=sG0rVdnDJMHH8ge5p4CQAQ&amp;gws_rd=cr">doing a search for one of my books</a> (yes, I am a victim too). If you’re an author, just search for your name, your book’s title and word <em>libri</em>. Do a search for a famous author and libri and go far enough down the search results (libri means book in Italian/Latin) and you’ll find them there too.</p><p>The numbers appear random, but are often shared across sites (they’re not totally unique), but they can be different too.</p><p>Further digging found this wasn’t the only path, some use the word <em>thread</em> instead of <em>libri</em>, some use <em>reviews</em>, although those two seem to be limited to examples where the whole domain has been compromised.</p><p>It quickly became clear that these pages were not being hosted with the knowledge of the domain’s owner. And to make matters even more interesting, the links changed their look occasionally. A page may appear to be the openmamba forum one time, KUF the next, and any one of up to eight other forums as well.</p><div class="gallery gallery-cols-3"><figure><a href="http://www.leepenney.com/img/pirate-cbf-hmaof.jpg"><img src="https://www.leepenney.com/img/1080/pirate-cbf-hmaof-150x150.jpg" alt="Example forum page"></a><figcaption>Example forum page</figcaption></figure><figure><a href="http://www.leepenney.com/img/pirate-cbf-inbox7.jpg"><img src="https://www.leepenney.com/img/1080/pirate-cbf-inbox7-150x150.jpg" alt="Another example page"></a><figcaption>Another example page</figcaption></figure><figure><a href="http://www.leepenney.com/img/pirate-kuf-wyodlc.jpg"><img src="https://www.leepenney.com/img/1080/pirate-kuf-wyodlc-150x150.jpg" alt="Example KUF-branded page"></a><figcaption>Example KUF-branded page</figcaption></figure></div><p>On one such page, which appeared as KUF, the thread looked to have been started by someone called Marmoospres, but when you clicked the avatar you were taken through to <a href="http://www.kuforum.co.uk/kindleusersforum/user-4196.html">my profile</a>. That explained why people were contacting me.</p><h3 id="examining-the-source-code">Examining the Source Code</h3><p>Being a web guy, I decided to start examining the source code to see if I could figure out what was going on.</p><p>One thing I noticed was that the source files (images, CSS, etc) of the original sites were being hosted on a domain called wunnibook.us. I quickly found copies of a page from each of the forums under numbered subdomains (9.wunnibook.us being KUF). The page they happened to copy was a thread I started, which explained the link to my profile (and why the wonderful <a href="http://www.kathmiddletonbooks.com/">Kath</a> is being pestered, definitely no karma there, she deserves good things, not this).</p><p>The whole reason for these pages appears to be a single link. It often appears to point to LibraryThing, with the suggestion you can download/access free books, which you can’t. I have found examples that purport to go to a free book search engine.</p><p>The links actually point to a file called red.html (or sometimes got.html) in a subdirectory called router. It’s a very simple file that called a JavaScript function from a linked JavaScript file, with the name of the book.</p><p>The JavaScript file (called variously red.js or general1.js) has a single function (my) that builds a URL comprising of various domains, which appear to exist purely to host a cgi file (actually just more JavaScript) that takes the name of the book as a parameter. When the URL is built, the browser is redirected to the URL. After bouncing between a couple of scripts you end up either at a site that appears to allow you to search for free books (but wants you to register) or a download site.</p><p>The forum pages themselves are fakes, they’re not legitimate posters, they’re constructed by a script. Whatever creates them seems to generate a html subfolder. Each book then seems to get its own subfolder (could be virtual) and the index page loads a file called med.js which has a lot of variables; from user names to post contents, to avatar image URLs.</p><p>jQuery is then used to load another file from the folder, the one I’m looking at uses 1v.f (by way of example). That file is again JavaScript, outputting the stolen forum page. It also merges seemingly random variables from the med.js file, which dynamically generates the page. There are a range of those files, each one corresponding to a the subdomain of the fake forum files they copied (9v.f relates to KUF for example).</p><p>On the ones branded like Sainsbury’s, when the index file in the book folder is called it uses jQuery to pull in the content from a file inside the router folder. The one I am currently looking at is called html.f2 in a subfolder called subby.</p><h3 id="identifying-the-problem">Identifying the Problem</h3><p>Having figured out how the pages are constructed, I started trying to identify the attack vector that had been used. How had so many sites been compromised to host this stuff?</p><p>Many of the sites were running WordPress, but plenty were not. Most were hosted on Apache servers, but several were on nginx and at least one appeared to be using IIS. They ran a range of operating systems (CentOs, Gentoo, other Linux distros and Windows). They all seemed to run PHP (even the IIS one), but different versions.</p><p>The domains were from various registries, they were registered through different registrars, and they appeared to be hosted all over the place, from the UK and US to Australia, Macedonia, Brazil and all points in between.</p><p>I still haven’t found a pattern. It does appear the sites that have been taken over entirely are from poorly maintained or abandoned domains, but they would need to be for someone to replace their content without it being noticed immediately.</p><p>With so many differing servers I can only assume they are generating the structures as folders, rather than modifying htaccess (or similar) files to add rules, but I can’t state that as a fact. It’s going to need someone better at this than I am to figure out how access to so many sites has been achieved (we’re talking thousands of sites).</p><h3 id="requesting-a-takedown">Requesting a Takedown</h3><p>Having identified wunnibook.us as the source of the fake forum files, allowing the sites to appear to be from sites there were not (although, in some cases, these files are hosted on the hacked site), I tried to track down the host.</p><p>I wasn’t convinced by the contact details on the whois record, especially the email address, so decided to skip those. It gave the registrar as Internet.BS Corp. – I figured that had to be BS, but it turns out BS is the top-level domain (TLD) for the Bahamas, and Internet.BS is a registrar that has previously had a <a href="http://arstechnica.com/business/2012/03/see-no-evil-2-regisrars-issue-half-of-worlds-rogue-online-drug-domains/">reputation for hosting ‘rogue’ pharmacy sites</a>, but has since <a href="http://blog.legitscript.com/2012/12/internet-bs-domain-name-registrar-does-180-internet-pharmacy-crime/">turned that around</a> and was <a href="https://www.centralnic.com/company/news/2014/centralnic-buys-domain-name-registrar-internet-bs-ibs">bought by CentralNic in 2014</a>.</p><p>I focused on the domain host, looking at the nameservers, which were all subdomains of topdns.com. That seems to have its own dark history. So I used <a href="http://www.whoishostingthis.com/">WhoIsHostingThis</a>? to try and track down the host. They pointed me at Serverius, a company who seems to be based in the Netherlands, but the IP address of the A record pointed me at 3net, whose website appears defunct. I emailed both to request they take a look at the site. No joy so far.</p><h3 id="what-s-it-all-about">What’s it all About?</h3><p>I not 100% sure about the why yet. This was a lot of work to set up (hacking multiple domains, creating scripts, scraping content) just to offer people free content. Add to that the fact that a number of authors have reported these links are for books that aren’t even available yet. The evidence leads me to one conclusion: malware.</p><p>I could be wrong, it may just be a way to harvest email addresses for spam, but the fact that PDF has long been a vector for infection would suggest it’s designed as a way to get people to infect themselves (to what end I don’t know, maybe just to build a botnet).</p><h3 id="the-long-and-short">The Long and Short</h3><p>For authors, the message is simple: don’t panic. I don’t think the downloaded files will be offering free copies of your books. If they are, take the view of Cory Doctorow: piracy is better than obscurity.</p><p>This appears to be a grand scheme to capture traffic and drive it to a site where visitors can self-infect their computers, or at least that’s my best guess.</p><p>For readers, it’s an eye-opener about getting free content from untrusted sources. There are plenty of places to get free books, legitimately.</p><p>Something that stood out in the communications I received, was how many authors were willing to give me a copy of their material. So if you find yourself wanting something, try and get hold of the author and just ask, they may well be happy to gain a reader.</p></div></article></main><footer><p>&copy; Lee Penney. All rights reserved.</p></footer></body></html>